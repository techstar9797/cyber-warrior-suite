[
  {
    "name": "Unauthorized Modbus Write to Holding Registers",
    "if": {
      "protocol": "ModbusTCP",
      "functionCode": [5, 6, 15, 16],
      "authenticated": false
    },
    "actions": ["slack:#ot-soc"],
    "severity": "critical"
  },
  {
    "name": "MQTT Publish Rate Anomaly",
    "if": {
      "protocol": "MQTT",
      "ratePerMin": { ">": 120 }
    },
    "actions": ["slack:#ot-soc", "email:ops@company.com"],
    "severity": "high"
  },
  {
    "name": "Firmware Version Drift Detection",
    "if": {
      "event": "firmware_change",
      "contains": "beta"
    },
    "actions": ["slack:#ot-soc"],
    "severity": "medium"
  },
  {
    "name": "Lateral Movement IT to OT",
    "if": {
      "srcNetwork": "192.168.0.0/16",
      "destNetwork": "10.50.0.0/16",
      "destPort": [502, 44818, 20000]
    },
    "actions": ["slack:#ot-soc", "block"],
    "severity": "critical"
  },
  {
    "name": "Rogue Engineering Workstation",
    "if": {
      "macAddress": { "notIn": "known_devices" },
      "protocol": ["OPCUA", "S7"],
      "authenticated": false
    },
    "actions": ["slack:#ot-soc", "quarantine"],
    "severity": "critical"
  },
  {
    "name": "Setpoint Tampering Beyond Safe Limits",
    "if": {
      "parameter": ["mixerSpeed", "pressure", "temperature"],
      "valueChange": { ">": 0.3 },
      "exceedsSafeMax": true
    },
    "actions": ["slack:#ot-soc", "alert:hmi"],
    "severity": "high"
  },
  {
    "name": "Unsafe Mode Change",
    "if": {
      "mode": ["manual", "override"],
      "during": "production"
    },
    "actions": ["slack:#ot-soc"],
    "severity": "high"
  }
]
